{"version":3,"sources":["webpack://ReactWhiteboard/webpack/universalModuleDefinition","webpack://ReactWhiteboard/webpack/bootstrap","webpack://ReactWhiteboard/external \"react\"","webpack://ReactWhiteboard/./node_modules/events/events.js","webpack://ReactWhiteboard/./src/Constants.js","webpack://ReactWhiteboard/./src/EventStream.js","webpack://ReactWhiteboard/./src/EventStore.js","webpack://ReactWhiteboard/./src/CursorPane.js","webpack://ReactWhiteboard/./src/CanvasPane.js","webpack://ReactWhiteboard/./src/Whiteboard.js","webpack://ReactWhiteboard/./src/SvgConverter.js","webpack://ReactWhiteboard/./src/index.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","ReflectOwnKeys","R","Reflect","ReflectApply","apply","target","receiver","args","Function","ownKeys","getOwnPropertySymbols","getOwnPropertyNames","concat","NumberIsNaN","Number","isNaN","EventEmitter","init","this","_events","undefined","_eventsCount","_maxListeners","defaultMaxListeners","$getMaxListeners","that","_addListener","type","listener","prepend","events","existing","warning","TypeError","newListener","emit","unshift","push","length","warned","w","Error","String","emitter","count","console","warn","_onceWrap","state","fired","wrapFn","wrapped","arguments","removeListener","_listeners","unwrap","evlistener","arr","ret","Array","unwrapListeners","arrayClone","listenerCount","copy","set","arg","RangeError","getPrototypeOf","setMaxListeners","getMaxListeners","doError","error","er","err","message","context","handler","len","listeners","addListener","on","prependListener","once","prependOnceListener","list","position","originalListener","shift","index","pop","spliceOne","off","removeAllListeners","keys","rawListeners","eventNames","MODE","HAND","DRAW_LINE","DRAG_IMAGE","NW_RESIZE_IMAGE","NE_RESIZE_IMAGE","SE_RESIZE_IMAGE","SW_RESIZE_IMAGE","SVG_ELEMENT_TYPE","LINE","IMAGE","EventStream","_classCallCheck","layer","x","y","width","change","color","point","height","dataUrl","image","move","resizeType","EventStore","EventStore_classCallCheck","selectedLayer","renderableLayers","goodEvents","undoEvents","last","Constants","_this","reduce","prev","element","forEach","strokeWidth","strokeColor","values","event","map","filter","lastImage","CursorPane","_React$Component","props","CursorPane_classCallCheck","_possibleConstructorReturn","_getPrototypeOf","dragStart","resizeStart","_inherits","React","Component","ev","_this$props$events","_this2","startDrawing","_toConsumableArray","nativeEvent","offsetX","offsetY","eventToPoint","stopDrawing","_this$props$events2","_this3","pushPoint","dragHandle","eventStore","base","unit","Math","ceil","moveX","moveY","dragImage","pageX","pageY","setState","resizeImage","startDragging","stopDragging","preventDefault","stopPropagation","startResizing","stopResizing","cursorLayerStyle","zIndex","borderStyle","borderColor","external_react_default","a","createElement","role","style","onClick","onClickCursorLayer","onMouseMove","onMouseMoveCursorLayer","renderImageHandle","_this4","mathMinOrMax","min","max","top","bottom","left","right","dragHandleStyle","cursor","nwResizeHandleStyle","neResizeHandleStyle","seResizeHandleStyle","swResizeHandleStyle","ref","onClickDragHandle","onClickResizeHandle","CanvasPane","CanvasPane_classCallCheck","CanvasPane_possibleConstructorReturn","CanvasPane_getPrototypeOf","svgElement","CanvasPane_inherits","canvasLayerStyle","version","xmlns","xmlnsXlink","fill","backgroundColor","drawWhiteboardCanvas","drawImageBorder","reduceEvents","join","stroke","xlinkHref","strokeDasharray","Whiteboard","Whiteboard_classCallCheck","Whiteboard_possibleConstructorReturn","Whiteboard_getPrototypeOf","canvas","Whiteboard_inherits","getSvgElement","setupEventHandler","selectLayer","addLayer","changeStrokeWidth","changeStrokeColor","pasteImage","undo","redo","clear","nwResizeImage","neResizeImage","seResizeImage","swResizeImage","wrapperStyle","assign","CursorPane_CursorPane","CanvasPane_CanvasPane","_extends","defaultProps","SvgConverter","SvgConverter_classCallCheck","sourceNode","htmlText","outerHTML","base64EncodedText","btoa","encodeURIComponent","replace","match","p1","fromCharCode","parseInt","Promise","resolve","toDataUrl","imageType","toSvgData","then","svgdata","_sourceNode$getBoundi","getBoundingClientRect","imageNode","Image","onload","canvasNode","document","graphicsContext","getContext","drawImage","toDataURL","src","imageUrl","fromImageUrl","crossOrigin","__webpack_exports__","Whiteboard_Whiteboard","EventStream_EventStream","EventStore_EventStore","Constants_namespaceObject"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ReactWhiteboard\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"ReactWhiteboard\"] = factory(root[\"react\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar R = typeof Reflect === 'object' ? Reflect : null\nvar ReflectApply = R && typeof R.apply === 'function'\n  ? R.apply\n  : function ReflectApply(target, receiver, args) {\n    return Function.prototype.apply.call(target, receiver, args);\n  }\n\nvar ReflectOwnKeys\nif (R && typeof R.ownKeys === 'function') {\n  ReflectOwnKeys = R.ownKeys\n} else if (Object.getOwnPropertySymbols) {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target)\n      .concat(Object.getOwnPropertySymbols(target));\n  };\n} else {\n  ReflectOwnKeys = function ReflectOwnKeys(target) {\n    return Object.getOwnPropertyNames(target);\n  };\n}\n\nfunction ProcessEmitWarning(warning) {\n  if (console && console.warn) console.warn(warning);\n}\n\nvar NumberIsNaN = Number.isNaN || function NumberIsNaN(value) {\n  return value !== value;\n}\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nmodule.exports = EventEmitter;\n\n// Backwards-compat with node 0.10.x\nEventEmitter.EventEmitter = EventEmitter;\n\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._eventsCount = 0;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nvar defaultMaxListeners = 10;\n\nObject.defineProperty(EventEmitter, 'defaultMaxListeners', {\n  enumerable: true,\n  get: function() {\n    return defaultMaxListeners;\n  },\n  set: function(arg) {\n    if (typeof arg !== 'number' || arg < 0 || NumberIsNaN(arg)) {\n      throw new RangeError('The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received ' + arg + '.');\n    }\n    defaultMaxListeners = arg;\n  }\n});\n\nEventEmitter.init = function() {\n\n  if (this._events === undefined ||\n      this._events === Object.getPrototypeOf(this)._events) {\n    this._events = Object.create(null);\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || NumberIsNaN(n)) {\n    throw new RangeError('The value of \"n\" is out of range. It must be a non-negative number. Received ' + n + '.');\n  }\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\nEventEmitter.prototype.emit = function emit(type) {\n  var args = [];\n  for (var i = 1; i < arguments.length; i++) args.push(arguments[i]);\n  var doError = (type === 'error');\n\n  var events = this._events;\n  if (events !== undefined)\n    doError = (doError && events.error === undefined);\n  else if (!doError)\n    return false;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    var er;\n    if (args.length > 0)\n      er = args[0];\n    if (er instanceof Error) {\n      // Note: The comments on the `throw` lines are intentional, they show\n      // up in Node's output if this results in an unhandled exception.\n      throw er; // Unhandled 'error' event\n    }\n    // At least give some kind of context to the user\n    var err = new Error('Unhandled error.' + (er ? ' (' + er.message + ')' : ''));\n    err.context = er;\n    throw err; // Unhandled 'error' event\n  }\n\n  var handler = events[type];\n\n  if (handler === undefined)\n    return false;\n\n  if (typeof handler === 'function') {\n    ReflectApply(handler, this, args);\n  } else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      ReflectApply(listeners[i], this, args);\n  }\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n\n  events = target._events;\n  if (events === undefined) {\n    events = target._events = Object.create(null);\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener !== undefined) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (existing === undefined) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] =\n        prepend ? [listener, existing] : [existing, listener];\n      // If we've already got an array, just append.\n    } else if (prepend) {\n      existing.unshift(listener);\n    } else {\n      existing.push(listener);\n    }\n\n    // Check for listener leak\n    m = $getMaxListeners(target);\n    if (m > 0 && existing.length > m && !existing.warned) {\n      existing.warned = true;\n      // No error code for this since it is a Warning\n      // eslint-disable-next-line no-restricted-syntax\n      var w = new Error('Possible EventEmitter memory leak detected. ' +\n                          existing.length + ' ' + String(type) + ' listeners ' +\n                          'added. Use emitter.setMaxListeners() to ' +\n                          'increase limit');\n      w.name = 'MaxListenersExceededWarning';\n      w.emitter = target;\n      w.type = type;\n      w.count = existing.length;\n      ProcessEmitWarning(w);\n    }\n  }\n\n  return target;\n}\n\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction onceWrapper() {\n  var args = [];\n  for (var i = 0; i < arguments.length; i++) args.push(arguments[i]);\n  if (!this.fired) {\n    this.target.removeListener(this.type, this.wrapFn);\n    this.fired = true;\n    ReflectApply(this.listener, this.target, args);\n  }\n}\n\nfunction _onceWrap(target, type, listener) {\n  var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n  var wrapped = onceWrapper.bind(state);\n  wrapped.listener = listener;\n  state.wrapFn = wrapped;\n  return wrapped;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function') {\n    throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n  }\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// Emits a 'removeListener' event if and only if the listener was removed.\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function') {\n        throw new TypeError('The \"listener\" argument must be of type Function. Received type ' + typeof listener);\n      }\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      list = events[type];\n      if (list === undefined)\n        return this;\n\n      if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0)\n          this._events = Object.create(null);\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n          if (list[i] === listener || list[i].listener === listener) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (position === 0)\n          list.shift();\n        else {\n          spliceOne(list, position);\n        }\n\n        if (list.length === 1)\n          events[type] = list[0];\n\n        if (events.removeListener !== undefined)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events, i;\n\n      events = this._events;\n      if (events === undefined)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (events.removeListener === undefined) {\n        if (arguments.length === 0) {\n          this._events = Object.create(null);\n          this._eventsCount = 0;\n        } else if (events[type] !== undefined) {\n          if (--this._eventsCount === 0)\n            this._events = Object.create(null);\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        var key;\n        for (i = 0; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = Object.create(null);\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners !== undefined) {\n        // LIFO order\n        for (i = listeners.length - 1; i >= 0; i--) {\n          this.removeListener(type, listeners[i]);\n        }\n      }\n\n      return this;\n    };\n\nfunction _listeners(target, type, unwrap) {\n  var events = target._events;\n\n  if (events === undefined)\n    return [];\n\n  var evlistener = events[type];\n  if (evlistener === undefined)\n    return [];\n\n  if (typeof evlistener === 'function')\n    return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n  return unwrap ?\n    unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  return _listeners(this, type, true);\n};\n\nEventEmitter.prototype.rawListeners = function rawListeners(type) {\n  return _listeners(this, type, false);\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events !== undefined) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener !== undefined) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? ReflectOwnKeys(this._events) : [];\n};\n\nfunction arrayClone(arr, n) {\n  var copy = new Array(n);\n  for (var i = 0; i < n; ++i)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction spliceOne(list, index) {\n  for (; index + 1 < list.length; index++)\n    list[index] = list[index + 1];\n  list.pop();\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","// @flow\n\nexport const MODE = {\n    HAND: 'HAND',\n    DRAW_LINE: 'DRAW_LINE',\n    DRAG_IMAGE: 'DRAG_IMAGE',\n    NW_RESIZE_IMAGE: 'NW_RESIZE_IMAGE',\n    NE_RESIZE_IMAGE: 'NE_RESIZE_IMAGE',\n    SE_RESIZE_IMAGE: 'SE_RESIZE_IMAGE',\n    SW_RESIZE_IMAGE: 'SW_RESIZE_IMAGE'\n}\n\nexport const SVG_ELEMENT_TYPE = {\n    LINE: 'LINE',\n    IMAGE: 'IMAGE'\n}\n\nexport type ModeType =\n    typeof MODE.HAND |\n    typeof MODE.DRAW_LINE |\n    typeof MODE.DRAG_IMAGE |\n    typeof MODE.NW_RESIZE_IMAGE |\n    typeof MODE.NE_RESIZE_IMAGE |\n    typeof MODE.SE_RESIZE_IMAGE |\n    typeof MODE.SW_RESIZE_IMAGE;\n\nexport type ResizeType =\n    typeof MODE.NW_RESIZE_IMAGE |\n    typeof MODE.NE_RESIZE_IMAGE |\n    typeof MODE.SE_RESIZE_IMAGE |\n    typeof MODE.SW_RESIZE_IMAGE;\n","// @flow\n\nimport EventEmitter from 'events'\nimport type {ResizeType} from './Constants'\nimport type {ImageDataType, MoveDataType, PointDataType} from './EventStore'\n\n\ntype listenerType = (any) => void;\n\nexport type StrokeWidthType = {\n    key: 'strokeWidth',\n    value: number\n};\n\nexport type StrokeColorType = {\n    key: 'strokeColor',\n    value: string\n};\n\nexport class EventStream {\n\n    emitter: EventEmitter\n\n    constructor() {\n        this.emitter = new EventEmitter()\n    }\n\n    on(name: string, listener: listenerType) {\n        this.emitter.on(name, listener)\n    }\n\n    selectLayer(layer: number) {\n        this.emitter.emit('selectLayer', layer)\n    }\n\n    addLayer() {\n        this.emitter.emit('addLayer')\n    }\n\n    startDrawing(x: number, y: number) {\n        this.emitter.emit('start', {x: x, y: y})\n    }\n\n    stopDrawing() {\n        this.emitter.emit('stop')\n    }\n\n    changeStrokeWidth(width: number) {\n        const change: StrokeWidthType = {key: 'strokeWidth', value: width}\n        this.emitter.emit('set', change)\n    }\n\n    changeStrokeColor(color: string) {\n        const change: StrokeColorType = {key: 'strokeColor', value: color}\n        this.emitter.emit('set', change)\n    }\n\n    pushPoint(x: number, y: number) {\n        const point: PointDataType = {x: x, y: y}\n        this.emitter.emit('push', point)\n    }\n\n    pasteImage(x: number, y: number, width: number, height: number, dataUrl: string) {\n        const image: ImageDataType = {x: x, y: y, width: width, height: height, dataUrl: dataUrl}\n        this.emitter.emit('paste', image)\n    }\n\n    startDragging() {\n        this.emitter.emit('startDragging')\n    }\n\n    stopDragging() {\n        this.emitter.emit('stopDragging')\n    }\n\n    dragImage(x: number, y: number) {\n        const move: MoveDataType = {x: x, y: y}\n        this.emitter.emit('drag', move)\n    }\n\n    startResizing(resizeType: ResizeType) {\n        this.emitter.emit('startResizing', resizeType)\n    }\n\n    stopResizing() {\n        this.emitter.emit('stopResizing')\n    }\n\n    resizeImage(x: number, y: number) {\n        const move: MoveDataType = {x: x, y: y}\n        this.emitter.emit('resize', move)\n    }\n\n    undo() {\n        this.emitter.emit('undo')\n    }\n\n    redo() {\n        this.emitter.emit('redo')\n    }\n\n    clear() {\n        this.emitter.emit('clear')\n    }\n}\n","// @flow\n\nimport * as Constants from './Constants'\n\n\nexport type PointDataType = {\n    x: number,\n    y: number\n};\n\nexport type ImageDataType = {\n    x?: number,\n    y?: number,\n    width: number,\n    height: number,\n    dataUrl: string\n};\n\nexport type MoveDataType = {\n    x: number,\n    y: number\n};\n\nexport type PointEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.LINE,\n    layer: number,\n    strokeWidth: number,\n    strokeColor: string,\n    point: PointDataType\n};\n\nexport type ImageEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.IMAGE,\n    layer: number,\n    image: ImageDataType\n};\n\nexport type StopEventType = {\n    type?: null\n};\n\nexport type AnyEventType = PointEventType | ImageEventType | StopEventType;\n\nexport type ReducedLineEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.LINE,\n    strokeWidth: number,\n    strokeColor: string,\n    values: Array<PointDataType>\n};\n\nexport type ReducedImageEventType = {\n    type: typeof Constants.SVG_ELEMENT_TYPE.IMAGE,\n    image: ImageDataType\n};\n\nexport type ReducedStopEventType = {\n    type?: null\n};\n\nexport type AnyReducedEventType = ReducedLineEventType | ReducedImageEventType | ReducedStopEventType;\n\nexport class EventStore {\n\n    selectedLayer: number\n    renderableLayers: Array<boolean>\n    goodEvents: Array<AnyEventType>\n    undoEvents: Array<AnyEventType>\n\n    constructor() {\n        this.selectedLayer = 0\n        this.renderableLayers = [true]\n        this.goodEvents = []\n        this.undoEvents = []\n    }\n\n    lastImage(): ?ImageDataType {\n        const last = this.goodEvents[this.goodEvents.length - 1]\n        if (last && last.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n            return last.image\n        } else {\n            return null\n        }\n    }\n\n    reduceEvents(): Array<AnyReducedEventType> {\n        return this.goodEvents.reduce((prev: Array<Array<AnyReducedEventType>>, element: AnyEventType): Array<Array<AnyReducedEventType>> => {\n                if (!element.type) {\n                    prev.forEach(p => {\n                        p.push({})\n                    })\n                    return prev\n                }\n\n                if (element.type === Constants.SVG_ELEMENT_TYPE.LINE) {\n                    let last = prev[element.layer][prev[element.layer].length - 1]\n                    if (last && last.type === Constants.SVG_ELEMENT_TYPE.LINE && last.strokeWidth === element.strokeWidth && last.strokeColor === element.strokeColor) {\n                        last.values.push(element.point)\n                    } else {\n                        const event: ReducedLineEventType = {\n                            type: element.type,\n                            strokeWidth: element.strokeWidth,\n                            strokeColor: element.strokeColor,\n                            values: [element.point]\n                        }\n                        prev[element.layer].push(event)\n                    }\n                    return prev\n\n                } else if (element.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n                    const event: ReducedImageEventType = {\n                        type: element.type,\n                        image: element.image\n                    }\n                    prev[element.layer].push(event)\n                    return prev\n\n                } else {\n                    return prev\n                }\n\n            }, this.renderableLayers.map(() => [])\n        ).filter((element: Array<AnyReducedEventType>, index: number): boolean => {\n            return this.renderableLayers[index]\n\n        }).reduce((prev: Array<AnyReducedEventType>, element: Array<AnyReducedEventType>): Array<AnyReducedEventType> => {\n                return prev.concat(element)\n\n            }, []\n        ).filter((element: AnyReducedEventType): boolean => {\n            if (element.type === Constants.SVG_ELEMENT_TYPE.LINE) {\n                return element.values.length > 1\n            } else if (element.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n                return true\n            } else {\n                return true\n            }\n        })\n    }\n\n    selectLayer(layer: number) {\n        this.goodEvents.push({})\n        this.selectedLayer = layer\n    }\n\n    addLayer() {\n        this.renderableLayers.push(true)\n    }\n\n    startDrawing(strokeWidth: number, strokeColor: string, point: PointDataType) {\n        this.goodEvents.push({\n            type: Constants.SVG_ELEMENT_TYPE.LINE,\n            layer: this.selectedLayer,\n            strokeWidth: strokeWidth,\n            strokeColor: strokeColor,\n            point: point\n        })\n    }\n\n    stopDrawing() {\n        this.goodEvents.push({})\n    }\n\n    pushPoint(strokeWidth: number, strokeColor: string, point: PointDataType) {\n        const event: PointEventType = {\n            type: Constants.SVG_ELEMENT_TYPE.LINE,\n            layer: this.selectedLayer,\n            strokeWidth: strokeWidth,\n            strokeColor: strokeColor,\n            point: point\n        }\n        this.goodEvents.push(event)\n        this.undoEvents = []\n    }\n\n    pasteImage(image: ImageDataType) {\n        const event: ImageEventType = {\n            type: Constants.SVG_ELEMENT_TYPE.IMAGE,\n            layer: this.selectedLayer,\n            image: image\n        }\n        this.goodEvents.push(event)\n        this.undoEvents = []\n    }\n\n    dragImage(move: MoveDataType) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x\n            lastImage.y = lastImage.y + move.y\n        }\n    }\n\n    nwResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x\n            lastImage.y = lastImage.y + move.y\n            lastImage.width = lastImage.width - move.x\n            lastImage.height = lastImage.height - move.y\n        }\n    }\n\n    neResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            // lastImage.x = lastImage.x + move.x;\n            lastImage.y = lastImage.y + move.y\n            lastImage.width = lastImage.width + move.x\n            lastImage.height = lastImage.height - move.y\n        }\n    }\n\n    seResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            // lastImage.x = lastImage.x + move.x;\n            // lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width + move.x\n            lastImage.height = lastImage.height + move.y\n        }\n    }\n\n    swResizeImage(move: MoveDataType) {\n        const lastImage = this.lastImage()\n        if (lastImage) {\n            lastImage.x = lastImage.x + move.x\n            // lastImage.y = lastImage.y + move.y;\n            lastImage.width = lastImage.width - move.x\n            lastImage.height = lastImage.height + move.y\n        }\n    }\n\n    undo() {\n        if (this.goodEvents.length) {\n            this.undoEvents.push(this.goodEvents.pop()) // {}\n            this.undoEvents.push(this.goodEvents.pop()) // {type: 'line', point: [...], ...} or {type: 'image', image: {...}, ...}\n            this.goodEvents.push({})\n        }\n    }\n\n    redo() {\n        if (this.undoEvents.length) {\n            this.goodEvents.pop()\n            this.goodEvents.push(this.undoEvents.pop()) // {type: 'line', point: [...], ...} or {type: 'image', image: {...}, ...}\n            this.goodEvents.push(this.undoEvents.pop()) // {}\n        }\n    }\n\n    clear() {\n        this.goodEvents = []\n        this.undoEvents = []\n    }\n}\n","// @flow\n\nimport React from 'react'\n\nimport type {ModeType, ResizeType} from './Constants'\nimport * as Constants from './Constants'\nimport {EventStream} from './EventStream'\nimport type {PointDataType} from './EventStore'\nimport {EventStore} from './EventStore'\n\n\ntype propsType = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    mode: ModeType,\n    strokeWidth: number,\n    strokeColor: string\n};\n\ntype stateType = {\n    dragStart: ?PointDataType,\n    resizeStart: ?PointDataType\n};\n\ntype mouseEventType = {\n    nativeEvent: {\n        offsetX: number,\n        offsetY: number\n    }\n} & SyntheticMouseEvent<HTMLDivElement>;\n\nexport class CursorPane extends React.Component<propsType, stateType> {\n\n    props: propsType\n    state: stateType\n\n    dragHandle: ?HTMLElement\n\n    constructor(props: propsType) {\n        super(props)\n\n        this.state = {\n            dragStart: null,\n            resizeStart: null\n        }\n    }\n\n    onClickCursorLayer(ev: mouseEventType) {\n        let eventToPoint = (ev: mouseEventType): Array<number> => {\n            const x = ev.nativeEvent.offsetX - 2\n            const y = ev.nativeEvent.offsetY + (2 * (this.props.strokeWidth / 3))\n            return [x, y]\n        }\n\n        if (this.props.mode === Constants.MODE.HAND) {\n            this.props.events.startDrawing(...eventToPoint(ev))\n        } else {\n            this.props.events.stopDrawing()\n        }\n    }\n\n    onMouseMoveCursorLayer(ev: mouseEventType) {\n        let eventToPoint = (ev: mouseEventType): Array<number> => {\n            const x = ev.nativeEvent.offsetX - 2\n            const y = ev.nativeEvent.offsetY + (2 * (this.props.strokeWidth / 3))\n            return [x, y]\n        }\n\n        if (this.props.mode === Constants.MODE.DRAW_LINE) {\n            this.props.events.pushPoint(...eventToPoint(ev))\n        } else if (this.props.mode === Constants.MODE.DRAG_IMAGE) {\n            if (ev.target !== this.dragHandle) {\n                return\n            }\n\n            const lastImage = this.props.eventStore.lastImage()\n            if (!lastImage) {\n                return\n            }\n\n            if (this.state.dragStart) {\n                const base = (lastImage.width < lastImage.height) ? lastImage.width : lastImage.height\n                const unit = (base / 8) < 20 ? Math.ceil(base / 8) : 20\n\n                const moveX = lastImage.x + unit < 0 ? ev.nativeEvent.offsetX - this.state.dragStart.x - (lastImage.x + unit) : ev.nativeEvent.offsetX - this.state.dragStart.x\n                const moveY = lastImage.y + unit < 0 ? ev.nativeEvent.offsetY - this.state.dragStart.y - (lastImage.y + unit) : ev.nativeEvent.offsetY - this.state.dragStart.y\n\n                this.props.events.dragImage(moveX, moveY)\n            }\n        } else if (this.props.mode === Constants.MODE.NW_RESIZE_IMAGE || this.props.mode === Constants.MODE.NE_RESIZE_IMAGE || this.props.mode === Constants.MODE.SE_RESIZE_IMAGE || this.props.mode === Constants.MODE.SW_RESIZE_IMAGE) {\n            const lastImage = this.props.eventStore.lastImage()\n            if (!lastImage) {\n                return\n            }\n\n            if (this.state.resizeStart) {\n                const moveX = ev.pageX - this.state.resizeStart.x\n                const moveY = ev.pageY - this.state.resizeStart.y\n\n                // do nothing if cannot resize image\n                if (this.props.mode === Constants.MODE.NW_RESIZE_IMAGE && (lastImage.width - moveX < 0 || lastImage.height - moveY < 0)) {\n                    return\n                } else if (this.props.mode === Constants.MODE.NE_RESIZE_IMAGE && (lastImage.width + moveX < 0 || lastImage.height - moveY < 0)) {\n                    return\n                } else if (this.props.mode === Constants.MODE.SE_RESIZE_IMAGE && (lastImage.width + moveX < 0 || lastImage.height + moveY < 0)) {\n                    return\n                } else if (this.props.mode === Constants.MODE.SW_RESIZE_IMAGE && (lastImage.width - moveX < 0 || lastImage.height + moveY < 0)) {\n                    return\n                }\n\n                this.setState({resizeStart: {x: ev.pageX, y: ev.pageY}})\n                this.props.events.resizeImage(moveX, moveY)\n            }\n        }\n    }\n\n    onClickDragHandle(ev: mouseEventType) {\n        if (this.props.mode === Constants.MODE.HAND) {\n            this.setState({dragStart: {x: ev.nativeEvent.offsetX, y: ev.nativeEvent.offsetY}})\n            this.props.events.startDragging()\n        } else {\n            this.setState({dragStart: null})\n            this.props.events.stopDragging()\n        }\n        ev.preventDefault()\n        ev.stopPropagation()\n    }\n\n    onClickResizeHandle(resizeType: ResizeType, ev: mouseEventType) {\n        if (this.props.mode === Constants.MODE.HAND) {\n            this.setState({resizeStart: {x: ev.pageX, y: ev.pageY}})\n            this.props.events.startResizing(resizeType)\n        } else {\n            this.setState({resizeStart: null})\n            this.props.events.stopResizing()\n        }\n        ev.preventDefault()\n        ev.stopPropagation()\n    }\n\n    render() {\n        const cursorLayerStyle = {\n            position: 'absolute',\n            zIndex: 2000,\n            width: this.props.width,\n            height: this.props.height,\n            borderStyle: 'none none solid none',\n            borderColor: this.props.strokeColor\n        }\n\n        return (\n            <div role=\"presentation\" style={cursorLayerStyle}\n                 onClick={this.onClickCursorLayer.bind(this)} onMouseMove={this.onMouseMoveCursorLayer.bind(this)}>\n                {this.renderImageHandle()}\n            </div>\n        )\n    }\n\n    renderImageHandle(): ?Array<React$Element<any>> {\n        const lastImage = this.props.eventStore.lastImage()\n        if (!lastImage) {\n            return null\n        }\n\n        const base = (lastImage.width < lastImage.height) ? lastImage.width : lastImage.height\n        const unit = (base / 8) < 20 ? Math.ceil(base / 8) : 20\n\n        const mathMinOrMax = (min: number, max: number, value: number): number => {\n            if (value < min) {\n                return min\n            } else if (value > max) {\n                return max\n            } else {\n                return value\n            }\n        }\n\n        const top = mathMinOrMax(0, this.props.height, lastImage.y + unit)\n        const bottom = mathMinOrMax(0, this.props.height, lastImage.y + lastImage.height - unit)\n        const left = mathMinOrMax(0, this.props.width, lastImage.x + unit)\n        const right = mathMinOrMax(0, this.props.width, lastImage.x + lastImage.width - unit)\n\n        const dragHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: top,\n            left: left,\n            width: right - left,\n            height: bottom - top,\n            cursor: 'move'\n        }\n\n        const nwResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: mathMinOrMax(0, this.props.height, top - unit),\n            left: mathMinOrMax(0, this.props.width, left - unit),\n            width: left - mathMinOrMax(0, this.props.width, left - unit),\n            height: top - mathMinOrMax(0, this.props.height, top - unit),\n            cursor: 'nw-resize'\n        }\n\n        const neResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: mathMinOrMax(0, this.props.height, top - unit),\n            left: right,\n            width: mathMinOrMax(0, this.props.width, right + unit) - right,\n            height: top - mathMinOrMax(0, this.props.height, top - unit),\n            cursor: 'ne-resize'\n        }\n\n        const seResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: bottom,\n            left: right,\n            width: mathMinOrMax(0, this.props.width, right + unit) - right,\n            height: mathMinOrMax(0, this.props.height, bottom + unit) - bottom,\n            cursor: 'se-resize'\n        }\n\n        const swResizeHandleStyle = {\n            position: 'absolute',\n            zIndex: 2500,\n            top: bottom,\n            left: mathMinOrMax(0, this.props.width, left - unit),\n            width: left - mathMinOrMax(0, this.props.width, left - unit),\n            height: mathMinOrMax(0, this.props.height, bottom + unit) - bottom,\n            cursor: 'sw-resize'\n        }\n\n        return ([\n            <div key=\"drag\" role=\"presentation\" style={dragHandleStyle}\n                 ref={dragHandle => this.dragHandle = dragHandle} onClick={this.onClickDragHandle.bind(this)}/>,\n            <div key=\"nw-resize\" role=\"presentation\" style={nwResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.NW_RESIZE_IMAGE)}/>,\n            <div key=\"ne-resize\" role=\"presentation\" style={neResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.NE_RESIZE_IMAGE)}/>,\n            <div key=\"se-resize\" role=\"presentation\" style={seResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.SE_RESIZE_IMAGE)}/>,\n            <div key=\"sw-resize\" role=\"presentation\" style={swResizeHandleStyle}\n                 onClick={this.onClickResizeHandle.bind(this, Constants.MODE.SW_RESIZE_IMAGE)}/>\n        ])\n    }\n}\n","// @flow\n\nimport React from 'react'\n\nimport * as Constants from './Constants'\nimport type {AnyReducedEventType, ImageDataType, PointDataType} from './EventStore'\nimport {EventStore} from './EventStore'\n\n\ntype propsType = {\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n};\n\ntype stateType = {};\n\nexport class CanvasPane extends React.Component<propsType, stateType> {\n\n    props: propsType\n    state: stateType\n\n    svgElement: ?Element\n\n    constructor(props: propsType) {\n        super(props)\n\n        this.svgElement = null\n    }\n\n    getSvgElement(): ?Element {\n        return this.svgElement\n    }\n\n    render() {\n        const canvasLayerStyle = {\n            position: 'absolute',\n            width: this.props.width,\n            height: this.props.height\n        }\n\n        return (\n            <div style={canvasLayerStyle}>\n                <svg ref={element => this.svgElement = element}\n                     version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n                     width={this.props.width} height={this.props.height}>\n                    <rect width={'100%'} height={'100%'} fill={this.props.style.backgroundColor}/>\n                    {this.drawWhiteboardCanvas()}\n                    {this.drawImageBorder()}\n                </svg>\n            </div>\n        )\n    }\n\n    drawWhiteboardCanvas(): Array<?React$Element<any>> {\n        return this.props.eventStore.reduceEvents().map((element: AnyReducedEventType, index: number): ?React$Element<any> => {\n            if (element.type === Constants.SVG_ELEMENT_TYPE.LINE) {\n                const key = index\n                const d = element.values.map((point: PointDataType, index: number) => {\n                    if (index === 0) {\n                        return 'M ' + point.x + ' ' + point.y\n                    } else {\n                        return 'L ' + point.x + ' ' + point.y\n                    }\n                })\n\n                return (\n                    <path key={key} d={d.join(' ')} fill=\"none\" stroke={element.strokeColor} strokeWidth={element.strokeWidth}/>\n                )\n\n            } else if (element.type === Constants.SVG_ELEMENT_TYPE.IMAGE) {\n                const key = index\n                const image: ImageDataType = element.image\n\n                return (\n                    <image key={key} x={image.x} y={image.y} width={image.width} height={image.height} xlinkHref={image.dataUrl}/>\n                )\n\n            } else {\n                return null\n            }\n        })\n    }\n\n    drawImageBorder(): ?React$Element<any> {\n        const lastImage = this.props.eventStore.lastImage()\n        if (!lastImage) {\n            return null\n        }\n\n        return (\n            <rect x={lastImage.x} y={lastImage.y} width={lastImage.width} height={lastImage.height}\n                  fill={'none'} stroke={'black'} strokeDasharray={'5,5'}/>\n        )\n    }\n}\n","// @flow\n\nimport React from 'react'\n\nimport type {ModeType, ResizeType} from './Constants'\nimport * as Constants from './Constants'\nimport type {StrokeColorType, StrokeWidthType} from './EventStream'\nimport {EventStream} from './EventStream'\nimport type {ImageDataType, MoveDataType, PointDataType} from './EventStore'\nimport {EventStore} from './EventStore'\nimport {CursorPane} from './CursorPane'\nimport {CanvasPane} from './CanvasPane'\n\n\ntype defaultPropsType = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n};\n\ntype propsType = {\n    events: EventStream,\n    eventStore: EventStore,\n    width: number,\n    height: number,\n    style: {\n        backgroundColor: string\n    }\n};\n\ntype stateType = {\n    eventStore: EventStore,\n    mode: ModeType,\n    layer: number,\n    strokeWidth: number,\n    strokeColor: string\n};\n\nexport class Whiteboard extends React.Component<propsType, stateType> {\n\n    static defaultProps: defaultPropsType\n    props: propsType\n    state: stateType\n\n    canvas: ?CanvasPane\n\n    constructor(props: propsType) {\n        super(props)\n\n        this.state = {\n            eventStore: props.eventStore,\n            mode: Constants.MODE.HAND,\n            layer: 0,\n            strokeWidth: 5,\n            strokeColor: 'black'\n        }\n\n        this.canvas = null\n    }\n\n    getSvgElement(): ?Element {\n        if (this.canvas) {\n            return this.canvas.getSvgElement()\n        }\n    }\n\n    componentDidMount() {\n        this.setupEventHandler()\n    }\n\n    setupEventHandler() {\n        this.props.events.on('selectLayer', this.selectLayer.bind(this))\n        this.props.events.on('addLayer', this.addLayer.bind(this))\n\n        this.props.events.on('start', this.startDrawing.bind(this))\n        this.props.events.on('stop', this.stopDrawing.bind(this))\n\n        this.props.events.on('set', (event: StrokeWidthType | StrokeColorType) => {\n            if (event.key === 'strokeWidth') {\n                this.changeStrokeWidth(event.value)\n            }\n            if (event.key === 'strokeColor') {\n                this.changeStrokeColor(event.value)\n            }\n        })\n\n        this.props.events.on('push', this.pushPoint.bind(this))\n\n        this.props.events.on('paste', this.pasteImage.bind(this))\n        this.props.events.on('startDragging', this.startDragging.bind(this))\n        this.props.events.on('stopDragging', this.stopDragging.bind(this))\n        this.props.events.on('drag', this.dragImage.bind(this))\n        this.props.events.on('startResizing', this.startResizing.bind(this))\n        this.props.events.on('stopResizing', this.stopResizing.bind(this))\n        this.props.events.on('resize', this.resizeImage.bind(this))\n\n        this.props.events.on('undo', this.undo.bind(this))\n        this.props.events.on('redo', this.redo.bind(this))\n        this.props.events.on('clear', this.clear.bind(this))\n    }\n\n    selectLayer(layer: number) {\n        this.state.eventStore.selectLayer(layer)\n        this.setState({\n            layer: layer,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    addLayer() {\n        this.state.eventStore.addLayer()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    startDrawing(point: PointDataType) {\n        this.state.eventStore.startDrawing(this.state.strokeWidth, this.state.strokeColor, point)\n        this.setState({\n            mode: Constants.MODE.DRAW_LINE,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    stopDrawing() {\n        this.state.eventStore.stopDrawing()\n        this.setState({\n            mode: Constants.MODE.HAND,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    changeStrokeWidth(width: number) {\n        this.state.eventStore.stopDrawing()\n        this.setState({\n            strokeWidth: width,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    changeStrokeColor(color: string) {\n        this.state.eventStore.stopDrawing()\n        this.setState({\n            strokeColor: color,\n            eventStore: this.state.eventStore\n        })\n    }\n\n    pushPoint(point: PointDataType) {\n        this.state.eventStore.pushPoint(this.state.strokeWidth, this.state.strokeColor, point)\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    pasteImage(image: ImageDataType) {\n        this.state.eventStore.pasteImage(image)\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    startDragging() {\n        this.setState({mode: Constants.MODE.DRAG_IMAGE})\n    }\n\n    stopDragging() {\n        this.setState({mode: Constants.MODE.HAND})\n    }\n\n    dragImage(move: MoveDataType) {\n        if (this.state.mode !== Constants.MODE.DRAG_IMAGE) {\n            return\n        }\n\n        this.state.eventStore.dragImage(move)\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    startResizing(resizeType: ResizeType) {\n        this.setState({mode: resizeType})\n    }\n\n    stopResizing() {\n        this.setState({mode: Constants.MODE.HAND})\n    }\n\n    resizeImage(move: MoveDataType) {\n        if (this.state.mode === Constants.MODE.NW_RESIZE_IMAGE) {\n            this.state.eventStore.nwResizeImage(move)\n            this.setState({eventStore: this.state.eventStore})\n        } else if (this.state.mode === Constants.MODE.NE_RESIZE_IMAGE) {\n            this.state.eventStore.neResizeImage(move)\n            this.setState({\n                eventStore: this.state.eventStore\n            })\n        } else if (this.state.mode === Constants.MODE.SE_RESIZE_IMAGE) {\n            this.state.eventStore.seResizeImage(move)\n            this.setState({\n                eventStore: this.state.eventStore\n            })\n        } else if (this.state.mode === Constants.MODE.SW_RESIZE_IMAGE) {\n            this.state.eventStore.swResizeImage(move)\n            this.setState({eventStore: this.state.eventStore})\n        }\n    }\n\n    undo() {\n        this.state.eventStore.undo()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    redo() {\n        this.state.eventStore.redo()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    clear() {\n        this.state.eventStore.clear()\n        this.setState({eventStore: this.state.eventStore})\n    }\n\n    render() {\n        const wrapperStyle = {\n            position: 'relative',\n            width: this.props.width,\n            height: this.props.height\n        }\n\n        const props = Object.assign({}, this.props, this.state)\n\n        return (\n            <div style={wrapperStyle}>\n                <CursorPane {...props}/>\n                <CanvasPane ref={canvas => this.canvas = canvas} {...props}/>\n            </div>\n        )\n    }\n}\n\nWhiteboard.defaultProps = {\n    events: new EventStream(),\n    eventStore: new EventStore(),\n    width: 400,\n    height: 400,\n    style: {\n        backgroundColor: 'none'\n    }\n}\n","// @flow\n\nimport type {ImageDataType} from './EventStore'\n\n\nexport class SvgConverter {\n\n    static toSvgData(sourceNode: HTMLElement): Promise<string> {\n        let htmlText = sourceNode.outerHTML\n        let base64EncodedText = window.btoa(\n            window.encodeURIComponent(htmlText)\n                .replace(/%([0-9A-F]{2})/g, (match: string, p1: string): string => String.fromCharCode(window.parseInt('0x' + p1))))\n\n        return new Promise(resolve => {\n            resolve('data:image/svg+xml;charset=utf-8;base64,' + base64EncodedText)\n        })\n    }\n\n    static toPngData(sourceNode: HTMLElement): Promise<string> {\n        return SvgConverter.toDataUrl(sourceNode, 'image/png')\n    }\n\n    static toJpegData(sourceNode: HTMLElement): Promise<string> {\n        return SvgConverter.toDataUrl(sourceNode, 'image/jpeg')\n    }\n\n    static toDataUrl(sourceNode: HTMLElement, imageType: string): Promise<string> {\n        return new Promise(resolve => {\n            SvgConverter.toSvgData(sourceNode).then((svgdata: string) => {\n                let {width, height} = sourceNode.getBoundingClientRect()\n\n                let imageNode = new window.Image()\n                imageNode.onload = () => {\n                    let canvasNode = document.createElement('canvas')\n                    canvasNode.width = width\n                    canvasNode.height = height\n\n                    let graphicsContext = canvasNode.getContext('2d')\n                    if (graphicsContext) {\n                        graphicsContext.drawImage(imageNode, 0, 0)\n                    } else {\n                        throw new Error('got no rendering context')\n                    }\n\n                    resolve(canvasNode.toDataURL(imageType))\n                }\n                imageNode.src = svgdata\n            })\n        })\n    }\n\n    static fromPngImage(imageUrl: string): Promise<ImageDataType> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/png')\n    }\n\n    static fromJpegImage(imageUrl: string): Promise<ImageDataType> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/jpeg')\n    }\n\n    static fromGifImage(imageUrl: string): Promise<ImageDataType> {\n        return SvgConverter.fromImageUrl(imageUrl, 'image/gif')\n    }\n\n    static fromImageUrl(imageUrl: string, imageType: string): Promise<ImageDataType> {\n        return new Promise(resolve => {\n            let imageNode = new window.Image()\n            imageNode.onload = () => {\n                let canvasNode = document.createElement('canvas')\n                canvasNode.width = imageNode.width\n                canvasNode.height = imageNode.height\n\n                let graphicsContext = canvasNode.getContext('2d')\n                if (graphicsContext) {\n                    graphicsContext.drawImage(imageNode, 0, 0)\n                } else {\n                    throw new Error('got no rendering context')\n                }\n\n                resolve({width: imageNode.width, height: imageNode.height, dataUrl: canvasNode.toDataURL(imageType)})\n            }\n            imageNode.crossOrigin = 'anonymous'\n            imageNode.src = imageUrl\n        })\n    }\n}\n","// @flow\n\nimport * as Constants from './Constants'\n\nexport {Whiteboard} from './Whiteboard'\nexport {EventStream} from './EventStream'\nexport {EventStore} from './EventStore'\nexport {SvgConverter} from './SvgConverter'\nexport {Constants}\n"],"sourceRoot":""}